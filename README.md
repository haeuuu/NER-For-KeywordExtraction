# NER-For-Keyword Extraction

### Named Entity Recognition for Keyword extraction from Online lecture

"온라인 학습도우미 PLUS" 의 두 번째 기능인 '키워드 추출'을 위한 repo입니다.
  
  
#### Keyword

* Named Entity Recognition
* BERT
* Conditional Random Field
* TF-IDF
  
  
  
## :peach: Train Data / Test data

##### NER 대회용 데이터와 한국민족문화대백과사전에서 스크래핑한 데이터를 섞어 train/test
  
  
  
### 1. Naver/창원대 NLP Challenge

> 네이버와 창원대에서 개최한 NLP challenge의 train set

##### 	아래와 같은 총 14개의 개체명 태그가 존재한다.

1. `PERSON`	PER	실존, 가상 등 인물명에 해당 하는 것
2. `FIELD`	FLD	학문 분야 및 이론, 법칙, 기술 등
3. `ARTIFACTS_WORKS`	AFW	인공물로 사람에 의해 창조된 대상물
4. `ORGANIZATION`	ORG	기관 및 단체와 회의/회담을 모두 포함
5. `LOCATION`	LOC	지역명칭과 행정구역 명칭 등
6. `CIVILIZATION`	CVL	문명 및 문화에 관련된 용어
7. `DATE`	DAT	날짜
8. `TIME`	TIM	시간
9. `NUMBER`	NUM	숫자
10. `EVENT`	EVT	특정 사건 및 사고 명칭과 행사 등
11. `ANIMAL`	ANM	동물
12. `PLANT`	PLT	식물
13. `MATERIAL`	MAT	금속, 암석, 화학물질 등
14. `TERM`	TRM	의학 용어, IT곤련 용어 등 일반 용어를 총칭
  
  
  
#### NOTE

* `index`는 새로운 문장이 시작될 때마다 1로 초기화된다.
* `tag`의 앞부분은 개체명의 의미를, 뒷부분은 BIO tagging을 뜻한다.
* B는 개체명의 시작 어절, I는 끝 어절, -는 개체명이 아닌 어절을 뜻한다.
* 두 개체명이 조합된 경우, 앞에 등장하는 개체명을 따라 태그를 부여한다. 
  ex ) 포항공과대학교(LOC_B) 컴퓨터공학과(ORG_B) => LOC로 부여
  
  
  
### 2. 한국민족문화대백과사전

* 인물, 지명, 문화재, 유물, 단체 등의 카테고리를 이용하여 true tag를 생성

  1. 각 카테고리에 접근한다.

  2. 단체 카테고리에 속하는 단어들은 모두 `ORG `를 true tag로 지정한다.

  3. NER 학습을 위해서는 문장이 필요하다. 해당 단어가 포함된 설명을 스크래핑한다.

     > `교민` : `-` , `중국` : `-` , `관헌도` : `-` ,  `간민회` : `ORG_B`

  4. true tag가 달리지 않은 `교민`, `중국`, `관헌도 `등은 **기존의 model(acc 97%)를 이용하여 약한 정답**을 생성한다.

     > **기존 모델에 의한 정답**  `교민` : `PER` , `중국` : `LOC` , `관헌도` : `LOC`  ,`간민회` : `-`
     >
     > **스크래핑으로 생성한 정답**  `교민` : `-` , `중국` : `-` , `관헌도` : `-` ,  `간민회` : `ORG_B`
     >
     > **=> 최종 모델에 대한 정답 ** `교민` : `PER` , `중국` : `LOC` , `관헌도` : `LOC`  ,`간민회` : `ORG_B`
  
  
  
  
#### NOTE

* 전체 카테고리 중 "유물","유적","작품","제도","지명","문헌","단체","문화재" 를 이용
  
  
  
  

## :peach: DistilBert + CRF

#### Model

* Knowledge distillation을 이용하여 경량화된 KoBERT를 이용

  > [DistilKoBERT](https://github.com/monologg/DistilKoBERT)

  * 12 layer를 3개의 layer로
  * 한국어 위키, 나무위키, 뉴스 등의 10GB 데이터로 3 epoch학습

* Accuracy : 0.9069
* 한국사에서 중요한 태그라고 생각되는 `PER`, `ORG`, `CVL`, `EVT`에 대해 f1-score는 약 0.81 ~ 0.88
* 주로 I tag를 잘 예측하지 못하는데, 이는 한국사 용어 특성상 여러가지 개체명이 결합되어있기 때문에 발생한 현상으로 보인다.

  ##### 특히 LOC_I의 score가 낮은 이유는 다음과 같이 추측해볼 수 있다.

  * 앞 글자가 LOC일 경우, 뒷 글자까지 LOC일 것으로 기대하지만 실제로는 아닌 경우가 많다. 이는 한국사 단어 특성상 여러 개체명이 뭉쳐있기 때문에 발생한다.
  * ex : `강릉농악`에서 `강릉`은 `LOC`이지만 `강릉농악`은 `AFW`
  * 위와 같은 이유로 LOC_I에 대한 규칙이 모호해지면서 예측력이 하락했을 것이다.
  



## :cherries: Results

1. `자막 `: 공민왕이 시해되면서, 칼에 맞아 죽게 되면서 그 개혁의 배턴을 누가 이어받느냐면 **신진사대부가** 이어받게 될 겁니다. 그래야 호족, **문벌귀족**, 무신, **권문세족**, **신진사대부**. 그 맥이 이어질 테니까요. 됐죠? 이게 바로 고려 오백 년의 흐름이에요. 기억나시죠? 좋습니다. 그렇다면 이제 다음 챕터로 대외 관계를 볼게요. 고려는 외침이 정말 많았던 나라입니다. 거란족의 침입, 여진족의 침입, 몽골의 침입, 홍건적과 왜구의 침입. 정말 많았거든요. 그 외침의 역사를 지금부터 하나씩 하나씩 볼 텐데 고려 파트에서 문제 두 문제 나온다고 그랬죠?

   ##### 추천 결과

   * '`문벌귀족`': '대대로 내려오는 그 집안의 사회적 신분이나 지위.'

   * '`권문세족`': '고려후기 정치세력으로 고려 전기의 문벌귀족, 조선의 양반사대부와 비견되는 지배층.권문세가.'

   * '`신진사대부`': '고려·조선시대 문관 관료의 총칭.', '공민왕': '고려후기 제31대(재위: 1351~1374) 왕.'

2. `자막` : **광종**입니다. 과거제, **노비안검법**. 그리고 공복은 앞에서 설명드렸죠. 백제 설명할 때 고이왕 할 때 공복과 관등이라는 것 제가 설명드렸잖아요. 옷 색깔 정하는 것. 그다음에 칭제건원. ‘내가 황제야. 내가 이제부터 연호 쓸 거야.’라고 하면서 자주적인 모습도 바로 이 광종 때 보여 주고 있더라는 얘기입니다. 이렇게 호족들 다 날렸어. 이제 안정을 되찾았겠죠. 이러면서 뭔가 완성시키는 왕이 등장합니다. 항상 완성의 의미를 갖고 있는 왕의 이름은 성종이에요. 조선 시대도 그렇고, 고려 시대도 그렇고. 그래서 성종이 등장을 합니다. 성종은 최승로의 시무 28조 건의를 받아들입니다.

   ##### 추천 결과 

   * '`노비안검법`': '고려 광종 때 호족세력을 누르고 왕권을 강화하기 위해 본래 양인이었다가 노비가 된 사람을 안검하여 방량(放良)하게 한 일종의 노비해방법.'
   * '`광종`': '고려전기 제4대(재위:949~975) 왕.'

3. `자막 `: **쌍성총관부**를 가져갑니다. 철령 이북 지역이거든요. 이 지역을 가져가는 모습들 보이고 있고요. 내정간섭. 정동행성의 이문소를 통해서 내정간섭 심해집니다. 정동행성은 왜 만들었냐면 일본 정벌하기 위해서. 정벌하는 거예요. 동쪽을 정벌하기 위해서 만든 기구라는 얘기인데 정동행성 이문소를 통해서 내정간섭 엄청나게 많이 합니다. 그리고 권문세족들은 정방. 정방 여러분, 기억나요? 기억이 나야지. 앞에서 했잖아. 무신정권 때 최충헌의 아들 최우가 인사권을 장악하기 위해서 만들었던 기구. 이걸 그대로 유지합니다. 왜?

   ##### 추천 결과

   * '`쌍성총관부`': '고려 후기 몽고가 고려의 화주(和州) 이북을 직접 통치하기 위해 설치했던 관부.'



## :lemon: Reference

* [KoBERT](https://github.com/SKTBrain/KoBERT)
* [DistilKoBERT](https://github.com/monologg/DistilKoBERT)
* [NER](https://github.com/eagle705/pytorch-bert-crf-ner)


